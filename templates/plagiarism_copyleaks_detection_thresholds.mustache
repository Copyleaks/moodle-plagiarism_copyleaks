<div class="slider-container">
    <div class="range-slider" data-slider="{{uid}}"></div>

    <input type="range" min="0" max="100" value="{{lowtomidthreshold}}" data-slider-low-to-mid="{{uid}}" name="{{lowtomidfieldname}}">
    <input type="range" min="0" max="100" value="{{midtohighthreshold}}" data-slider-mid-to-high="{{uid}}" name="{{midtohighfieldname}}">

    <div style="margin-top: 10px;">
        <p>{{#str}} cllowcontentmatchthreshold, plagiarism_copyleaks {{/str}} <span data-range-low="{{uid}}">0% - {{lowtomidthreshold}}%</span></p>
        <p>{{#str}} clmidcontentmatchthreshold, plagiarism_copyleaks {{/str}} <span data-range-mid="{{uid}}">{{lowtomidthreshold}}% - {{midtohighthreshold}}%</span></p>
        <p>{{#str}} clhighcontentmatchthreshold, plagiarism_copyleaks {{/str}} <span data-range-high="{{uid}}">{{midtohighthreshold}}% - 100%</span></p>
    </div>
</div>

{{#js}}
(function() {
    let uid = "{{uid}}";
    let lowToMidSlider = document.querySelector(`[data-slider-low-to-mid="${uid}"]`);
    let midToHighSlider = document.querySelector(`[data-slider-mid-to-high="${uid}"]`);
    let rangeLow = document.querySelector(`[data-range-low="${uid}"]`);
    let rangeMid = document.querySelector(`[data-range-mid="${uid}"]`);
    let rangeHigh = document.querySelector(`[data-range-high="${uid}"]`);
    let rangeSlider = document.querySelector(`[data-slider="${uid}"]`);

    function updateSlider() {
        let lowToMidValue = parseInt(lowToMidSlider.value);
        let midToHighValue = parseInt(midToHighSlider.value);

        // Ensure lowToMidValue never exceeds 98
        lowToMidValue = Math.min(lowToMidValue, 98);
        lowToMidSlider.value = lowToMidValue;

        // Ensure midToHighValue never drops below lowToMidValue + 1
        midToHighValue = Math.max(midToHighValue, lowToMidValue + 1);
        midToHighSlider.value = midToHighValue;

        // Ensure midToHighValue never exceeds 100
        midToHighValue = Math.min(midToHighValue, 100);

        // Adjust moderate range properly
        let moderateStart = lowToMidValue + 1;
        let moderateEnd = midToHighValue === 100 ? 99 : midToHighValue;
        let highStart = midToHighValue === 100 ? 100 : midToHighValue + 1;

        // Update displayed values
        rangeLow.textContent = `0% - ${lowToMidValue}%`;
        rangeMid.textContent = `${moderateStart}% - ${moderateEnd}%`;
        rangeHigh.textContent = `${highStart}% - 100%`;

        // Update slider background
        rangeSlider.style.background = `linear-gradient(to right, 
            #008001 0%, 
            #008001 ${lowToMidValue}%, 
            #ffa503 ${lowToMidValue}%, 
            #ffa503 ${moderateEnd}%, 
            #f44336 ${moderateEnd}%, 
            #f44336 100%)`;
    }

    function adjustLowToMid() {
        lowToMidSlider.value = Math.min(parseInt(lowToMidSlider.value), 98); // Never let it reach 99
        if (parseInt(lowToMidSlider.value) >= parseInt(midToHighSlider.value)) {
            midToHighSlider.value = parseInt(lowToMidSlider.value) + 1;
        }
        updateSlider();
    }

    function adjustMidToHigh() {
        if (parseInt(midToHighSlider.value) <= parseInt(lowToMidSlider.value)) {
            midToHighSlider.value = parseInt(lowToMidSlider.value) + 1;
        }
        updateSlider();
    }

    lowToMidSlider.addEventListener("input", adjustLowToMid);
    midToHighSlider.addEventListener("input", adjustMidToHigh);

    updateSlider();
})();
{{/js}}








